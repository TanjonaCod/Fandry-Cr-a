// ===== DONNÉES DE TRADUCTION =====
const translations = {
    mg: { // Malagasy
        logo: "Fandry Créa.",
        nav: {
            services: "Serivisy",
            work: "Asa",
            about: "Momba",
            contact: "Hifandray"
        },
        hero: {
            title: {
                part1: "Mamorona",
                part2: "vokatra nomerika",
                part3: "mahomby."
            },
            description: "Mamorona traikefa nomerika miavaka aho izay mampifangaro design vaovao sy fahaizana ara-teknika."
        },
        stats: {
            projects: "TETIKASA",
            satisfaction: "FAHAMPOANA",
            experience: "TAONA FIAINANA",
            clients: "MPANJIFA"
        },
        services: {
            title: "Serivisy",
            subtitle: "Vahaolana mifanaraka amin'ny tetikasanao nomerika",
            web: {
                title: "Fampandrosoana Web",
                description: "Tranonkala maoderina, mirindra ary mahomby amin'ny teknolojia farany."
            },
            mobile: {
                title: "Fampiharana Mobile",
                description: "Fampiharana iOS sy Android natoraly na cross-platform miaraka amin'ny Flutter sy React Native."
            },
            graphic: {
                title: "Sary & Marika",
                description: "Endrika hita maso, branding ary design graphique ho an'ny marika tsy hay hadinoina."
            },
            software: {
                title: "Vahaolana Rindrankajy",
                description: "Rindrankajy orinasa namboarina hanatsarana ny fizotran'ny orinasanao."
            },
            ecommerce: {
                title: "Varotra an-tserasera",
                description: "Fivarotana an-tserasera mahomby miaraka amin'ny fitantanana vokatra sy fandoavam-bola azo antoka."
            },
            seo: {
                title: "SEO & Marketing",
                description: "Fanatsarana ny motera fikarohana sy paikady marketing nomerika."
            }
        },
        projects: {
            title: "Tetikasa vao haingana",
            subtitle: "Hita ny tetikasako farany",
            ecommerce: {
                title: "Sehatra E-Commerce",
                description: "Sehatra fivarotana an-tserasera"
            },
            fitness: {
                title: "Fitness Tracker",
                description: "Fampiharana fanaraha-maso fanatanjahan-tena"
            },
            dashboard: {
                title: "Business Dashboard",
                description: "Tabilao fanaraha-maso analytique"
            },
            agency: {
                title: "Tranonkala masoivoho",
                description: "Tranonkala fampirantiana ho an'ny masoivoho"
            }
        },
        about: {
            title: "Tia ny nomerika sy ny fanavaozana",
            description: "Mamorona vokatra nomerika mampifangaro hatsarana sy fiasa aho. Ny tanjoko: manome aina ny hevitrao amin'ny vahaolana ara-teknika vaovao."
        },
        testimonial: {
            quote: "\"Mpamorona miavaka izay nahatakatra ny filanay ary nihoatra ny fanantenanay. Tena mahafinaritra ny vokatra!\"",
            author: "— Sarah M., Talen'ny Marketing"
        },
        contact: {
            title: "Avela ho velona ny tetikasanao",
            subtitle: "Manana hevitra ve ianao? Resaho izany!",
            email: "Mailaka",
            phone: "Telefaonina",
            form: {
                title: "Mandefasa hafatra",
                name: "Anaranao",
                email: "Mailakao",
                select: {
                    default: "Fidio serivisy",
                    web: "Fampandrosoana Web",
                    mobile: "Fampiharana Mobile",
                    design: "Design"
                },
                message: "Hafatrao",
                submit: "Mandefasa"
            }
        },
        footer: {
            brand: "Fandry-Créa",
            description: "Mamorona traikefa nomerika vaovao sy mahomby.",
            navigation: "Fitetezana",
            home: "Fandraisana",
            services: "Serivisy",
            projects: "Tetikasa",
            about: "Momba",
            services_title: "Serivisy",
            web: "Fampandrosoana Web",
            mobile: "Fampiharana Mobile",
            software: "Vahaolana Rindrankajy",
            design: "UX/UI Design",
            contact_title: "Hifandray",
            location: "Madagasikara, Antananarivo",
            copyright: "© 2026 Fandry-Créa. Zo rehetra voatokana. Natao tamin'ny <i class='fas fa-heart' style='color: #4f46e5;'></i>"
        }
    },
    
    fr: { // Français
        logo: "Fandry Créa.",
        nav: {
            services: "Services",
            work: "Réalisations",
            about: "À propos",
            contact: "Contact"
        },
        hero: {
            title: {
                part1: "Créer des",
                part2: "produits digitaux",
                part3: "performants."
            },
            description: "Nous créons des expériences digitales exceptionnelles qui allient design innovant et performance technique."
        },
        stats: {
            projects: "PROJETS",
            satisfaction: "SATISFACTION",
            experience: "ANS D'EXP",
            clients: "CLIENTS"
        },
        services: {
            title: "Services",
            subtitle: "Des solutions sur mesure pour vos projets digitaux",
            web: {
                title: "Développement Web",
                description: "Sites modernes, responsifs et performants avec les dernières technologies."
            },
            mobile: {
                title: "Applications Mobiles",
                description: "Applications iOS et Android natives ou cross-platform avec Flutter et React Native."
            },
            graphic: {
                title: "Graphisme & Marques",
                description: "Identité visuelle, branding et design graphique pour marques mémorables."
            },
            software: {
                title: "Solutions Logicielles",
                description: "Logiciels métier personnalisés pour optimiser vos processus d'entreprise."
            },
            ecommerce: {
                title: "E-commerce",
                description: "Boutiques en ligne performantes avec gestion de produits et paiements sécurisés."
            },
            seo: {
                title: "SEO & Marketing",
                description: "Optimisation pour moteurs de recherche et stratégies marketing digital."
            }
        },
        projects: {
            title: "Réalisations récentes",
            subtitle: "Découvrez mes derniers projets",
            ecommerce: {
                title: "Plateforme E-Commerce",
                description: "Plateforme de vente en ligne"
            },
            fitness: {
                title: "Fitness Tracker",
                description: "Application de suivi sportif"
            },
            dashboard: {
                title: "Tableau de Bord",
                description: "Tableau de bord analytique"
            },
            agency: {
                title: "Site Agence",
                description: "Site vitrine pour agence"
            }
        },
        about: {
            title: "Passionné par le digital et l'innovation",
            description: "Je crée des produits digitaux qui allient esthétique et fonctionnalité. Mon objectif : donner vie à vos idées avec des solutions techniques innovantes."
        },
        testimonial: {
            quote: "\"Un développeur exceptionnel qui a su comprendre nos besoins et dépasser nos attentes. Le résultat est magnifique !\"",
            author: "— Sarah M., Directrice Marketing"
        },
        contact: {
            title: "Donnons vie à vos projets",
            subtitle: "Vous avez une idée ? Discutons-en !",
            email: "Email",
            phone: "Téléphone",
            form: {
                title: "Envoyez un message",
                name: "Votre nom",
                email: "Votre email",
                select: {
                    default: "Sélectionnez un service",
                    web: "Développement Web",
                    mobile: "Application Mobile",
                    design: "Design"
                },
                message: "Votre message",
                submit: "Envoyer"
            }
        },
        footer: {
            brand: "Fandry-Créa",
            description: "Création d'expériences digitales innovantes et performantes.",
            navigation: "Navigation",
            home: "Accueil",
            services: "Services",
            projects: "Projets",
            about: "À propos",
            services_title: "Services",
            web: "Développement Web",
            mobile: "Applications Mobiles",
            software: "Solutions Logicielles",
            design: "UX/UI Design",
            contact_title: "Contact",
            location: "Madagascar, Antananarivo",
            copyright: "© 2026 Fandry-Créa. Tous droits réservés. Designé avec <i class='fas fa-heart' style='color: #4f46e5;'></i>"
        }
    },
    
    en: { // English
        logo: "Fandry Créa.",
        nav: {
            services: "Services",
            work: "Work",
            about: "About",
            contact: "Contact"
        },
        hero: {
            title: {
                part1: "Building",
                part2: "digital products",
                part3: "that perform."
            },
            description: "We create exceptional digital experiences that combine innovative design with technical performance."
        },
        stats: {
            projects: "PROJECTS",
            satisfaction: "SATISFACTION",
            experience: "YEARS EXP",
            clients: "CLIENTS"
        },
        services: {
            title: "Services",
            subtitle: "Tailored solutions for your digital projects",
            web: {
                title: "Web Development",
                description: "Modern, responsive and high-performance websites with the latest technologies."
            },
            mobile: {
                title: "Mobile Apps",
                description: "Native or cross-platform iOS and Android apps with Flutter and React Native."
            },
            graphic: {
                title: "Graphic & Brands",
                description: "Visual identity, branding and graphic design for memorable brands."
            },
            software: {
                title: "Software Solutions",
                description: "Custom business software to optimize your company processes."
            },
            ecommerce: {
                title: "E-commerce",
                description: "High-performance online stores with product management and secure payments."
            },
            seo: {
                title: "SEO & Marketing",
                description: "Search engine optimization and digital marketing strategies."
            }
        },
        projects: {
            title: "Recent Work",
            subtitle: "Discover my latest projects",
            ecommerce: {
                title: "E-Commerce Platform",
                description: "Online sales platform"
            },
            fitness: {
                title: "Fitness Tracker",
                description: "Sports tracking application"
            },
            dashboard: {
                title: "Business Dashboard",
                description: "Analytical dashboard"
            },
            agency: {
                title: "Agency Website",
                description: "Showcase website for agency"
            }
        },
        about: {
            title: "Passionate about digital and innovation",
            description: "We create digital products that combine aesthetics and functionality. My goal: bring your ideas to life with innovative technical solutions."
        },
        testimonial: {
            quote: "\"An exceptional developer who understood our needs and exceeded our expectations. The result is beautiful!\"",
            author: "— Sarah M., Marketing Director"
        },
        contact: {
            title: "Let's bring your projects to life",
            subtitle: "Have an idea? Let's talk about it!",
            email: "Email",
            phone: "Phone",
            form: {
                title: "Send a message",
                name: "Your name",
                email: "Your email",
                select: {
                    default: "Select a service",
                    web: "Web Development",
                    mobile: "Mobile App",
                    design: "Design"
                },
                message: "Your message",
                submit: "Send"
            }
        },
        footer: {
            brand: "Fandry-Créa",
            description: "Creating innovative and high-performance digital experiences.",
            navigation: "Navigation",
            home: "Home",
            services: "Services",
            projects: "Projects",
            about: "About",
            services_title: "Services",
            web: "Web Development",
            mobile: "Mobile Apps",
            software: "Software Solutions",
            design: "UX/UI Design",
            contact_title: "Contact",
            location: "Madagascar, Antananarivo",
            copyright: "© 2026 Fandry-Créa. All rights reserved. Designed with <i class='fas fa-heart' style='color: #4f46e5;'></i>"
        }
    }
};

// ===== FONCTION DE CHANGEMENT DE LANGUE =====
function changeLanguage(lang) {
    // Mettre à jour les boutons actifs
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.dataset.lang === lang) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
    
    // Traduire tous les éléments avec data-i18n
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const keys = element.dataset.i18n.split('.');
        let value = translations[lang];
        
        // Parcourir les clés pour obtenir la valeur
        for (let key of keys) {
            if (value && value[key]) {
                value = value[key];
            } else {
                value = null;
                break;
            }
        }
        
        if (value) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = value;
            } else if (element.tagName === 'OPTION') {
                element.textContent = value;
            } else {
                element.innerHTML = value;
            }
        }
    });
    
    // Traduire les placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const keys = element.dataset.i18nPlaceholder.split('.');
        let value = translations[lang];
        
        for (let key of keys) {
            if (value && value[key]) {
                value = value[key];
            } else {
                value = null;
                break;
            }
        }
        
        if (value) {
            element.placeholder = value;
        }
    });
    
    // Sauvegarder la langue choisie
    localStorage.setItem('preferred-language', lang);
}

// ===== CHARGER LA LANGUE SAUVEGARDÉE =====
function loadSavedLanguage() {
    const savedLang = localStorage.getItem('preferred-language') || 'fr';
    changeLanguage(savedLang);
}

// ===== MENU MOBILE =====
function toggleMenu() {
    const navLinks = document.getElementById('navLinks');
    navLinks.classList.toggle('active');
    
    const spans = document.querySelectorAll('.menu-toggle span');
    if (navLinks.classList.contains('active')) {
        spans[0].style.transform = 'rotate(45deg) translate(8px, 8px)';
        spans[1].style.opacity = '0';
        spans[2].style.transform = 'rotate(-45deg) translate(6px, -4px)';
    } else {
        spans[0].style.transform = 'none';
        spans[1].style.opacity = '1';
        spans[2].style.transform = 'none';
    }
}

// Fermer le menu mobile au clic sur un lien
document.querySelectorAll('.nav-links a').forEach(link => {
    link.addEventListener('click', () => {
        document.getElementById('navLinks').classList.remove('active');
    });
});

// ===== ANIMATION AU SCROLL =====
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
        }
    });
}, observerOptions);

document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

// ===== SLIDER SERVICES =====
const servicesTrack = document.getElementById('servicesTrack');
const serviceDots = document.querySelectorAll('#serviceDots .dot');
let serviceIndex = 0;
let servicesPerView = getServicesPerView();
const totalServices = document.querySelectorAll('.service-slide').length;

function getServicesPerView() {
    if (window.innerWidth <= 768) return 1;
    if (window.innerWidth <= 1200) return 2;
    return 3;
}

function updateServicesSlider() {
    servicesPerView = getServicesPerView();
    const slideWidth = document.querySelector('.service-slide')?.offsetWidth || 0;
    const gap = 8;
    const maxIndex = totalServices - servicesPerView;
    
    if (serviceIndex > maxIndex) serviceIndex = maxIndex;
    if (serviceIndex < 0) serviceIndex = 0;
    
    const translateX = -(serviceIndex * (slideWidth + gap));
    servicesTrack.style.transform = `translateX(${translateX}px)`;
    
    serviceDots.forEach((dot, index) => {
        if (index >= serviceIndex && index < serviceIndex + servicesPerView) {
            dot.classList.add('active');
        } else {
            dot.classList.remove('active');
        }
    });
}

function nextServiceSlide() {
    servicesPerView = getServicesPerView();
    const maxIndex = totalServices - servicesPerView;
    if (serviceIndex < maxIndex) {
        serviceIndex++;
    } else {
        serviceIndex = 0;
    }
    updateServicesSlider();
}

function prevServiceSlide() {
    servicesPerView = getServicesPerView();
    if (serviceIndex > 0) {
        serviceIndex--;
    } else {
        serviceIndex = totalServices - servicesPerView;
    }
    updateServicesSlider();
}

function goToServiceSlide(index) {
    servicesPerView = getServicesPerView();
    const maxIndex = totalServices - servicesPerView;
    serviceIndex = Math.min(index, maxIndex);
    updateServicesSlider();
}

// ===== SLIDER PROJETS =====
const projectsTrack = document.getElementById('projectsTrack');
const projectDots = document.querySelectorAll('#projectDots .dot');
let projectIndex = 0;
let projectsPerView = getProjectsPerView();
const totalProjects = document.querySelectorAll('.project-slide').length;

function getProjectsPerView() {
    if (window.innerWidth <= 768) return 1;
    if (window.innerWidth <= 1200) return 2;
    return 3;
}

function updateProjectsSlider() {
    projectsPerView = getProjectsPerView();
    const slideWidth = document.querySelector('.project-slide')?.offsetWidth || 0;
    const gap = 8;
    const maxIndex = totalProjects - projectsPerView;
    
    if (projectIndex > maxIndex) projectIndex = maxIndex;
    if (projectIndex < 0) projectIndex = 0;
    
    const translateX = -(projectIndex * (slideWidth + gap));
    projectsTrack.style.transform = `translateX(${translateX}px)`;
    
    projectDots.forEach((dot, index) => {
        if (index >= projectIndex && index < projectIndex + projectsPerView) {
            dot.classList.add('active');
        } else {
            dot.classList.remove('active');
        }
    });
}

function nextProjectSlide() {
    projectsPerView = getProjectsPerView();
    const maxIndex = totalProjects - projectsPerView;
    if (projectIndex < maxIndex) {
        projectIndex++;
    } else {
        projectIndex = 0;
    }
    updateProjectsSlider();
}

function prevProjectSlide() {
    projectsPerView = getProjectsPerView();
    if (projectIndex > 0) {
        projectIndex--;
    } else {
        projectIndex = totalProjects - projectsPerView;
    }
    updateProjectsSlider();
}

function goToProjectSlide(index) {
    projectsPerView = getProjectsPerView();
    const maxIndex = totalProjects - projectsPerView;
    projectIndex = Math.min(index, maxIndex);
    updateProjectsSlider();
}

// ===== INITIALISATION =====
window.addEventListener('resize', () => {
    updateServicesSlider();
    updateProjectsSlider();
});

window.addEventListener('load', () => {
    setTimeout(() => {
        updateServicesSlider();
        updateProjectsSlider();
    }, 100);
    
    // Charger la langue sauvegardée
    loadSavedLanguage();
});

// ===== AUTO-PLAY OPTIONNEL (décommentez pour activer) =====
let serviceAutoPlay = setInterval(nextServiceSlide, 5000);
let projectAutoPlay = setInterval(nextProjectSlide, 5000);

// Pause au survol
document.querySelector('.services-slider').addEventListener('mouseenter', () => {
    clearInterval(serviceAutoPlay);
});
document.querySelector('.services-slider').addEventListener('mouseleave', () => {
    serviceAutoPlay = setInterval(nextServiceSlide, 5000);
});